<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>结构化学三维动画实验室 | 四川轻化工大学</title>
    
    <!-- 字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- 主样式 -->
    <link rel="stylesheet" href="css/style.css">
    
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #16a085;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --gray: #95a5a6;
            --border: #dfe6e9;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background: #f9f9f9;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* 顶部栏 */
        .header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 0;
            border-bottom: 1px solid var(--border);
            background: white;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 20px rgba(0,0,0,0.05);
        }
        
        .header-left {
            display: flex;
            align-items: center;
        }
        
        .university-logo {
    width: 60px;
    height: 60px;
    margin-right: 15px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;  /* 新增：防止图片溢出圆角 */
    box-shadow: 0 4px 12px rgba(44, 62, 80, 0.1);
}

.university-logo img {
    width: 100%;      /* 图片宽度填满容器 */
    height: 100%;     /* 图片高度填满容器 */
    object-fit: contain;  /* 保持图片比例，完整显示 */
}
        
        .logo-content {
            display: flex;
            flex-direction: column;
        }
        
        .university-name {
            font-size: 16px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 2px;
        }
        
        .site-name {
            font-size: 12px;
            color: var(--gray);
            font-weight: 400;
        }
        
        /* 搜索栏样式 */
        .search-container {
            flex: 1;
            max-width: 500px;
            margin: 0 30px;
            position: relative;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: 1px solid var(--border);
            border-radius: 30px;
            font-size: 0.95rem;
            font-family: inherit;
            background: #f8f9fa;
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--secondary);
            background: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--border);
            border-radius: 10px;
            margin-top: 5px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            max-height: 400px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
        }
        
        .search-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .search-result-item:hover {
            background: #f8f9fa;
        }
        
        .search-result-title {
            font-weight: 500;
            color: var(--dark);
            margin-bottom: 3px;
        }
        
        .search-result-desc {
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .search-result-chapter {
            font-size: 0.75rem;
            color: var(--secondary);
            background: rgba(52, 152, 219, 0.1);
            padding: 2px 8px;
            border-radius: 10px;
            display: inline-block;
            margin-top: 5px;
        }
        
        .no-results {
            padding: 20px;
            text-align: center;
            color: var(--gray);
        }
        
        .search-filters {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 6px 12px;
            background: white;
            border: 1px solid var(--border);
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--gray);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-btn.active,
        .filter-btn:hover {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
        }
        
        .search-stats {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 10px;
            text-align: center;
        }
        
        /* 主标题 */
        .main-title {
            text-align: center;
            padding: 40px 0 30px;
        }
        
        .main-title h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
        }
        
        .main-title h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: var(--accent);
            border-radius: 2px;
        }
        
        .main-title p {
            font-size: 1.1rem;
            color: var(--gray);
            max-width: 700px;
            margin: 25px auto 0;
            line-height: 1.8;
        }
        
        /* 章节网格 */
        .chapters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            padding: 30px 0 60px;
        }
        
        .chapter-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 1px solid var(--border);
            height: 100%;
            display: flex;
            flex-direction: column;
            opacity: 1;
            transform: scale(1);
        }
        
        .chapter-card.hidden {
            display: none;
        }
        
        .chapter-card.filtered-out {
            opacity: 0.3;
            transform: scale(0.95);
        }
        
        .chapter-card:hover {
            transform: translateY(-5px) scale(1);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
            border-color: var(--secondary);
        }
        
        .chapter-image {
            height: 180px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            position: relative;
            overflow: hidden;
        }
        
        .chapter-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .chapter-card:hover .chapter-image img {
            transform: scale(1.05);
        }
        
        .chapter-number {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255,255,255,0.9);
            color: var(--dark);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 14px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .chapter-content {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .chapter-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 10px;
        }
        
        .chapter-desc {
            font-size: 0.95rem;
            color: var(--gray);
            line-height: 1.6;
            margin-bottom: 20px;
            flex-grow: 1;
        }
        
        .chapter-molecules {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .molecule-tag {
            background: rgba(52, 152, 219, 0.1);
            color: var(--secondary);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .view-animation {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--accent);
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            width: 100%;
        }
        
        .view-animation:hover {
            background: #149174;
            transform: translateY(-2px);
        }
        
        .view-animation i {
            margin-right: 8px;
            font-size: 0.9rem;
        }
        
        /* 搜索提示 */
        .search-hint {
            text-align: center;
            margin: 20px 0 40px;
            color: var(--gray);
            font-size: 0.95rem;
        }
        
        .search-hint .hint-item {
            display: inline-block;
            margin: 0 10px;
        }
        
        .hint-icon {
            background: rgba(52, 152, 219, 0.1);
            color: var(--secondary);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 5px;
        }
        
        /* 页脚 */
        .footer {
            background: var(--primary);
            color: white;
            padding: 40px 0 30px;
            margin-top: 40px;
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .footer-logo {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        .footer-logo i {
            color: var(--accent);
            margin-right: 8px;
        }
        
        .copyright {
            color: rgba(255,255,255,0.7);
            font-size: 0.9rem;
            margin-top: 20px;
        }
        
        .footer-links {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        
        .footer-link {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }
        
        .footer-link:hover {
            color: white;
        }
        
        /* 响应式设计 */
        @media (max-width: 992px) {
            .header {
                flex-direction: column;
                gap: 15px;
                padding: 15px 0;
            }
            
            .header-left {
                width: 100%;
                justify-content: center;
            }
            
            .search-container {
                margin: 0;
                width: 100%;
                max-width: 100%;
            }
            
            .main-title h1 {
                font-size: 2rem;
            }
        }
        
        @media (max-width: 768px) {
            .chapters-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .search-filters {
                justify-content: center;
            }
        }
        
        /* 章节图片占位符样式 */
        .image-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255,255,255,0.9);
            font-size: 3rem;
        }
        
        /* 简洁的动画效果 */
        .fade-in {
            opacity: 0;
            animation: fadeIn 0.8s ease forwards;
        }
        
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
        
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        .delay-5 { animation-delay: 0.5s; }
        
        /* 搜索结果高亮 */
        .highlight {
            background-color: #fff3cd;
            padding: 0 2px;
            border-radius: 2px;
        }
    </style>
</head>
<body>
    <!-- 顶部栏 -->
    <header class="header">
        <div class="container" style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;">
            <!-- 左侧：校徽和学校名称 -->
            <div class="header-left">
                <!-- 四川轻化工大学校徽 -->
<div class="university-logo">
    <img src="images/suse-logo.png" alt="四川轻化工大学校徽">
</div>
                
                <div class="logo-content">
                    <div class="university-name">四川轻化工大学</div>
                    <div class="site-name">结构化学三维动画实验室</div>
                </div>
            </div>
            
            <!-- 中间：搜索栏 -->
            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" class="search-input" placeholder="搜索章节、分子、关键词...">
                    <div id="searchResults" class="search-results"></div>
                </div>
                
                <!-- 搜索过滤器 -->
                <div class="search-filters">
                    <button class="filter-btn active" data-filter="all">全部</button>
                    <button class="filter-btn" data-filter="chapter">章节</button>
                    <button class="filter-btn" data-filter="molecule">分子</button>
                    <button class="filter-btn" data-filter="concept">概念</button>
                </div>
            </div>
            
            <!-- 右侧：可添加其他内容 -->
            <div style="width: 100px;"></div> <!-- 占位符，保持布局平衡 -->
        </div>
    </header>

    <!-- 主标题 -->
    <section class="main-title">
        <div class="container">
            <h1 class="fade-in">结构化学三维动画演示</h1>
            <p class="fade-in delay-1">
                本平台提供结构化学各章节核心概念的三维可视化动画，通过交互式模型帮助理解分子结构、对称性、晶体构造等抽象概念。
                点击下方章节图片即可查看对应的三维动画演示。
            </p>
            
            <!-- 搜索提示 -->
            <div class="search-hint fade-in delay-2">
                <div class="hint-item">
                    <span class="hint-icon"><i class="fas fa-lightbulb"></i></span>
                    提示：尝试搜索"原子轨道"、"分子对称性"、"晶体结构"等关键词
                </div>
                <div class="hint-item">
                    <span class="hint-icon"><i class="fas fa-tag"></i></span>
                    或点击分子标签如"H₂O"、"CH₄"进行筛选
                </div>
            </div>
        </div>
    </section>

    <!-- 章节网格 -->
    <main class="container">
        <!-- 搜索结果统计 -->
        <div id="searchStats" class="search-stats" style="display: none;">
            找到 <span id="resultCount">0</span> 个相关结果
        </div>
        
        <div class="chapters-grid" id="chaptersGrid">
            <!-- 第1章：原子结构 -->
            <div class="chapter-card fade-in delay-1" data-chapter="1" data-search="原子结构 量子力学 原子轨道 电子云 s轨道 p轨道 d轨道 f轨道 量子数 电子排布 H原子 He原子 电子云分布 概率密度">
                <div class="chapter-image">
                    <div class="chapter-number">01</div>
                    <div class="image-placeholder">
                        <i class="fas fa-atom"></i>
                    </div>
                </div>
                <div class="chapter-content">
                    <h3 class="chapter-title">原子结构与量子力学基础</h3>
                    <p class="chapter-desc">
                        原子轨道、电子云分布、量子数、电子排布规律的三维可视化。
                        展示s、p、d、f轨道的空间形状和电子概率密度分布。
                    </p>
                    <div class="chapter-molecules">
                        <span class="molecule-tag">H原子</span>
                        <span class="molecule-tag">He原子</span>
                        <span class="molecule-tag">电子云</span>
                        <span class="molecule-tag">s轨道</span>
                        <span class="molecule-tag">p轨道</span>
                    </div>
                    <a href="animation.html?chapter=1" class="view-animation">
                        <i class="fas fa-play-circle"></i> 查看原子轨道动画
                    </a>
                </div>
            </div>

            <!-- 第2章：分子结构 -->
            <div class="chapter-card fade-in delay-2" data-chapter="2" data-search="分子结构 化学键 共价键 离子键 金属键 价键理论 分子轨道理论 杂化轨道 VSEPR理论 键长 键角 H₂O 水分子 CH₄ 甲烷 CO₂ 二氧化碳 NH₃ 氨气">
                <div class="chapter-image">
                    <div class="chapter-number">02</div>
                    <div class="image-placeholder" style="background: linear-gradient(135deg, #3498db, #2ecc71);">
                        <i class="fas fa-water"></i>
                    </div>
                </div>
                <div class="chapter-content">
                    <h3 class="chapter-title">分子结构与化学键理论</h3>
                    <p class="chapter-desc">
                        共价键、离子键、金属键的形成过程与特征。
                        分子轨道理论、价键理论、杂化轨道理论的动态演示。
                    </p>
                    <div class="chapter-molecules">
                        <span class="molecule-tag">H₂O</span>
                        <span class="molecule-tag">CH₄</span>
                        <span class="molecule-tag">CO₂</span>
                        <span class="molecule-tag">NH₃</span>
                        <span class="molecule-tag">共价键</span>
                    </div>
                    <a href="animation.html?chapter=2" class="view-animation">
                        <i class="fas fa-play-circle"></i> 查看分子结构动画
                    </a>
                </div>
            </div>

            <!-- 第3章：分子对称性 -->
            <div class="chapter-card fade-in delay-3" data-chapter="3" data-search="分子对称性 群论 对称操作 对称元素 旋转轴 对称面 对称中心 反轴 点群 特征标表 C₆H₆ 苯 SF₆ 六氟化硫 CH₄ 甲烷 对称轴 对称面">
                <div class="chapter-image">
                    <div class="chapter-number">03</div>
                    <div class="image-placeholder" style="background: linear-gradient(135deg, #9b59b6, #e74c3c);">
                        <i class="fas fa-snowflake"></i>
                    </div>
                </div>
                <div class="chapter-content">
                    <h3 class="chapter-title">分子对称性与群论基础</h3>
                    <p class="chapter-desc">
                        对称操作与对称元素：旋转、反映、反演、旋转反映。
                        点群的分类与识别，特征标表的应用演示。
                    </p>
                    <div class="chapter-molecules">
                        <span class="molecule-tag">C₆H₆</span>
                        <span class="molecule-tag">SF₆</span>
                        <span class="molecule-tag">CH₄</span>
                        <span class="molecule-tag">对称轴</span>
                        <span class="molecule-tag">点群</span>
                    </div>
                    <a href="animation.html?chapter=3" class="view-animation">
                        <i class="fas fa-play-circle"></i> 查看对称性动画
                    </a>
                </div>
            </div>

            <!-- 第4章：晶体结构 -->
            <div class="chapter-card fade-in delay-4" data-chapter="4" data-search="晶体结构 X射线衍射 晶系 布拉维格子 晶胞 晶面指标 密堆积 面心立方 体心立方 六方密堆积 NaCl 氯化钠 金刚石 石墨 立方晶系 六方晶系">
                <div class="chapter-image">
                    <div class="chapter-number">04</div>
                    <div class="image-placeholder" style="background: linear-gradient(135deg, #e67e22, #f1c40f);">
                        <i class="fas fa-gem"></i>
                    </div>
                </div>
                <div class="chapter-content">
                    <h3 class="chapter-title">晶体结构与X射线衍射</h3>
                    <p class="chapter-desc">
                        七大晶系、十四种布拉维格子。
                        密堆积结构、晶胞参数、晶面指标、X射线衍射原理。
                    </p>
                    <div class="chapter-molecules">
                        <span class="molecule-tag">NaCl</span>
                        <span class="molecule-tag">金刚石</span>
                        <span class="molecule-tag">石墨</span>
                        <span class="molecule-tag">立方晶系</span>
                        <span class="molecule-tag">密堆积</span>
                    </div>
                    <a href="animation.html?chapter=4" class="view-animation">
                        <i class="fas fa-play-circle"></i> 查看晶体结构动画
                    </a>
                </div>
            </div>

            <!-- 第5章：配位化合物 -->
            <div class="chapter-card fade-in delay-5" data-chapter="5" data-search="配位化合物 配位场理论 配位键 配合物 几何构型 晶体场理论 分裂能 高自旋 低自旋 [Fe(CN)₆]⁴⁻ 六氰合铁(II) [Co(NH₃)₆]³⁺ 六氨合钴(III) 配位键 八面体 四面体">
                <div class="chapter-image">
                    <div class="chapter-number">05</div>
                    <div class="image-placeholder" style="background: linear-gradient(135deg, #1abc9c, #16a085);">
                        <i class="fas fa-star"></i>
                    </div>
                </div>
                <div class="chapter-content">
                    <h3 class="chapter-title">配位化合物与配位场理论</h3>
                    <p class="chapter-desc">
                        配位键的形成、配位化合物的几何构型。
                        晶体场理论、分裂能、高自旋与低自旋配合物。
                    </p>
                    <div class="chapter-molecules">
                        <span class="molecule-tag">[Fe(CN)₆]⁴⁻</span>
                        <span class="molecule-tag">[Co(NH₃)₆]³⁺</span>
                        <span class="molecule-tag">配位键</span>
                        <span class="molecule-tag">八面体</span>
                        <span class="molecule-tag">晶体场</span>
                    </div>
                    <a href="animation.html?chapter=5" class="view-animation">
                        <i class="fas fa-play-circle"></i> 查看配合物动画
                    </a>
                </div>
            </div>

            <!-- 第6章：分子光谱 -->
            <div class="chapter-card fade-in delay-1" data-chapter="6" data-search="分子光谱 结构分析 红外光谱 拉曼光谱 紫外可见光谱 振动模式 转动能级 电子跃迁 IR光谱 UV-Vis 振动模式 拉曼散射 光谱分析">
                <div class="chapter-image">
                    <div class="chapter-number">06</div>
                    <div class="image-placeholder" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                        <i class="fas fa-wave-square"></i>
                    </div>
                </div>
                <div class="chapter-content">
                    <h3 class="chapter-title">分子光谱与结构分析</h3>
                    <p class="chapter-desc">
                        红外光谱、拉曼光谱、紫外-可见光谱的原理。
                        振动模式、转动能级、电子跃迁的可视化演示。
                    </p>
                    <div class="chapter-molecules">
                        <span class="molecule-tag">IR光谱</span>
                        <span class="molecule-tag">UV-Vis</span>
                        <span class="molecule-tag">振动模式</span>
                        <span class="molecule-tag">拉曼散射</span>
                        <span class="molecule-tag">电子跃迁</span>
                    </div>
                    <a href="animation.html?chapter=6" class="view-animation">
                        <i class="fas fa-play-circle"></i> 查看分子光谱动画
                    </a>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-flask"></i> 结构化学实验室
                </div>
                <p>四川轻化工大学化学与环境工程学院</p>
                <p>提供结构化学教学辅助的三维可视化工具</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // 章节数据
        const chaptersData = [
            {
                id: 1,
                title: "原子结构与量子力学基础",
                desc: "原子轨道、电子云分布、量子数、电子排布规律的三维可视化。展示s、p、d、f轨道的空间形状和电子概率密度分布。",
                tags: ["H原子", "He原子", "电子云", "s轨道", "p轨道"],
                search: "原子结构 量子力学 原子轨道 电子云 s轨道 p轨道 d轨道 f轨道 量子数 电子排布 H原子 He原子 电子云分布 概率密度",
                chapter: "第1章"
            },
            {
                id: 2,
                title: "分子结构与化学键理论",
                desc: "共价键、离子键、金属键的形成过程与特征。分子轨道理论、价键理论、杂化轨道理论的动态演示。",
                tags: ["H₂O", "CH₄", "CO₂", "NH₃", "共价键"],
                search: "分子结构 化学键 共价键 离子键 金属键 价键理论 分子轨道理论 杂化轨道 VSEPR理论 键长 键角 H₂O 水分子 CH₄ 甲烷 CO₂ 二氧化碳 NH₃ 氨气",
                chapter: "第2章"
            },
            {
                id: 3,
                title: "分子对称性与群论基础",
                desc: "对称操作与对称元素：旋转、反映、反演、旋转反映。点群的分类与识别，特征标表的应用演示。",
                tags: ["C₆H₆", "SF₆", "CH₄", "对称轴", "点群"],
                search: "分子对称性 群论 对称操作 对称元素 旋转轴 对称面 对称中心 反轴 点群 特征标表 C₆H₆ 苯 SF₆ 六氟化硫 CH₄ 甲烷 对称轴 对称面",
                chapter: "第3章"
            },
            {
                id: 4,
                title: "晶体结构与X射线衍射",
                desc: "七大晶系、十四种布拉维格子。密堆积结构、晶胞参数、晶面指标、X射线衍射原理。",
                tags: ["NaCl", "金刚石", "石墨", "立方晶系", "密堆积"],
                search: "晶体结构 X射线衍射 晶系 布拉维格子 晶胞 晶面指标 密堆积 面心立方 体心立方 六方密堆积 NaCl 氯化钠 金刚石 石墨 立方晶系 六方晶系",
                chapter: "第4章"
            },
            {
                id: 5,
                title: "配位化合物与配位场理论",
                desc: "配位键的形成、配位化合物的几何构型。晶体场理论、分裂能、高自旋与低自旋配合物。",
                tags: ["[Fe(CN)₆]⁴⁻", "[Co(NH₃)₆]³⁺", "配位键", "八面体", "晶体场"],
                search: "配位化合物 配位场理论 配位键 配合物 几何构型 晶体场理论 分裂能 高自旋 低自旋 [Fe(CN)₆]⁴⁻ 六氰合铁(II) [Co(NH₃)₆]³⁺ 六氨合钴(III) 配位键 八面体 四面体",
                chapter: "第5章"
            },
            {
                id: 6,
                title: "分子光谱与结构分析",
                desc: "红外光谱、拉曼光谱、紫外-可见光谱的原理。振动模式、转动能级、电子跃迁的可视化演示。",
                tags: ["IR光谱", "UV-Vis", "振动模式", "拉曼散射", "电子跃迁"],
                search: "分子光谱 结构分析 红外光谱 拉曼光谱 紫外可见光谱 振动模式 转动能级 电子跃迁 IR光谱 UV-Vis 振动模式 拉曼散射 光谱分析",
                chapter: "第6章"
            }
        ];

        // 搜索功能
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const searchResults = document.getElementById('searchResults');
            const filterButtons = document.querySelectorAll('.filter-btn');
            const chaptersGrid = document.getElementById('chaptersGrid');
            const chapterCards = document.querySelectorAll('.chapter-card');
            const searchStats = document.getElementById('searchStats');
            const resultCount = document.getElementById('resultCount');
            
            let currentFilter = 'all';
            let currentSearchTerm = '';
            
            // 搜索输入事件
            searchInput.addEventListener('input', function() {
                currentSearchTerm = this.value.trim().toLowerCase();
                performSearch();
            });
            
            // 搜索框聚焦/失焦事件
            searchInput.addEventListener('focus', function() {
                if (currentSearchTerm) {
                    searchResults.style.display = 'block';
                }
            });
            
            document.addEventListener('click', function(e) {
                if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                    searchResults.style.display = 'none';
                }
            });
            
            // 过滤器按钮点击事件
            filterButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    // 移除所有按钮的active类
                    filterButtons.forEach(b => b.classList.remove('active'));
                    // 给当前按钮添加active类
                    this.classList.add('active');
                    currentFilter = this.getAttribute('data-filter');
                    performSearch();
                });
            });
            
            // 执行搜索
            function performSearch() {
                const searchTerm = currentSearchTerm;
                
                // 更新章节卡片显示
                updateChapterCards(searchTerm);
                
                // 更新搜索结果下拉列表
                updateSearchResults(searchTerm);
                
                // 显示/隐藏搜索结果统计
                if (searchTerm) {
                    searchStats.style.display = 'block';
                } else {
                    searchStats.style.display = 'none';
                }
            }
            
            // 更新章节卡片
            function updateChapterCards(searchTerm) {
                let visibleCount = 0;
                
                chapterCards.forEach(card => {
                    const title = card.querySelector('.chapter-title').textContent.toLowerCase();
                    const desc = card.querySelector('.chapter-desc').textContent.toLowerCase();
                    const tags = Array.from(card.querySelectorAll('.molecule-tag'))
                        .map(tag => tag.textContent.toLowerCase());
                    const searchData = card.getAttribute('data-search')?.toLowerCase() || '';
                    
                    // 检查是否匹配搜索词
                    const matchesSearch = !searchTerm || 
                        title.includes(searchTerm) || 
                        desc.includes(searchTerm) || 
                        tags.some(tag => tag.includes(searchTerm)) ||
                        searchData.includes(searchTerm);
                    
                    // 检查是否匹配过滤器
                    let matchesFilter = true;
                    if (currentFilter !== 'all') {
                        // 这里可以根据需要实现更复杂的过滤逻辑
                        matchesFilter = true; // 简化处理，实际可根据filter调整
                    }
                    
                    if (matchesSearch && matchesFilter) {
                        card.classList.remove('hidden', 'filtered-out');
                        visibleCount++;
                        
                        // 高亮匹配的文本
                        if (searchTerm) {
                            highlightText(card, searchTerm);
                        } else {
                            removeHighlights(card);
                        }
                    } else {
                        card.classList.add('filtered-out');
                    }
                });
                
                // 更新结果计数
                resultCount.textContent = visibleCount;
            }
            
            // 更新搜索结果下拉列表
            function updateSearchResults(searchTerm) {
                if (!searchTerm) {
                    searchResults.style.display = 'none';
                    searchResults.innerHTML = '';
                    return;
                }
                
                const results = [];
                
                // 在章节数据中搜索
                chaptersData.forEach(chapter => {
                    const titleMatch = chapter.title.toLowerCase().includes(searchTerm);
                    const descMatch = chapter.desc.toLowerCase().includes(searchTerm);
                    const tagsMatch = chapter.tags.some(tag => 
                        tag.toLowerCase().includes(searchTerm)
                    );
                    const searchMatch = chapter.search.toLowerCase().includes(searchTerm);
                    
                    if (titleMatch || descMatch || tagsMatch || searchMatch) {
                        // 计算匹配度（简单实现）
                        let relevance = 0;
                        if (titleMatch) relevance += 3;
                        if (tagsMatch) relevance += 2;
                        if (descMatch || searchMatch) relevance += 1;
                        
                        results.push({
                            ...chapter,
                            relevance
                        });
                    }
                });
                
                // 按相关度排序
                results.sort((a, b) => b.relevance - a.relevance);
                
                // 生成搜索结果HTML
                if (results.length > 0) {
                    let html = '';
                    
                    results.forEach(result => {
                        // 高亮显示搜索词
                        const highlightedTitle = highlightTextInString(result.title, searchTerm);
                        const highlightedDesc = highlightTextInString(
                            result.desc.substring(0, 100) + '...', 
                            searchTerm
                        );
                        
                        html += `
                            <div class="search-result-item" data-chapter="${result.id}">
                                <div class="search-result-title">${highlightedTitle}</div>
                                <div class="search-result-desc">${highlightedDesc}</div>
                                <div class="search-result-chapter">${result.chapter}</div>
                            </div>
                        `;
                    });
                    
                    // 添加快速搜索提示
                    html += `
                        <div class="search-hint" style="padding: 15px; border-top: 1px solid #f0f0f0;">
                            <div style="font-size: 0.85rem; color: #666; margin-bottom: 8px;">
                                <i class="fas fa-lightbulb" style="margin-right: 5px;"></i>
                                快速搜索建议：
                            </div>
                            <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                                <span class="filter-btn" style="font-size: 0.8rem; padding: 4px 8px;" onclick="setSearchTerm('原子轨道')">原子轨道</span>
                                <span class="filter-btn" style="font-size: 0.8rem; padding: 4px 8px;" onclick="setSearchTerm('分子对称性')">分子对称性</span>
                                <span class="filter-btn" style="font-size: 0.8rem; padding: 4px 8px;" onclick="setSearchTerm('晶体结构')">晶体结构</span>
                                <span class="filter-btn" style="font-size: 0.8rem; padding: 4px 8px;" onclick="setSearchTerm('H₂O')">H₂O</span>
                            </div>
                        </div>
                    `;
                    
                    searchResults.innerHTML = html;
                    searchResults.style.display = 'block';
                    
                    // 添加搜索结果点击事件
                    document.querySelectorAll('.search-result-item').forEach(item => {
                        item.addEventListener('click', function() {
                            const chapterId = this.getAttribute('data-chapter');
                            scrollToChapter(chapterId);
                            searchResults.style.display = 'none';
                        });
                    });
                } else {
                    searchResults.innerHTML = `
                        <div class="no-results">
                            <i class="fas fa-search" style="font-size: 1.5rem; margin-bottom: 10px; color: #ccc;"></i>
                            <div>未找到与"${searchTerm}"相关的内容</div>
                            <div style="font-size: 0.85rem; margin-top: 10px; color: #999;">
                                尝试搜索其他关键词，如"分子结构"、"化学键"等
                            </div>
                        </div>
                    `;
                    searchResults.style.display = 'block';
                }
            }
            
            // 高亮文本
            function highlightText(element, searchTerm) {
                // 移除之前的高亮
                removeHighlights(element);
                
                // 高亮标题
                const titleElement = element.querySelector('.chapter-title');
                if (titleElement) {
                    const originalText = titleElement.textContent;
                    const highlightedText = originalText.replace(
                        new RegExp(searchTerm, 'gi'),
                        match => `<span class="highlight">${match}</span>`
                    );
                    titleElement.innerHTML = highlightedText;
                }
                
                // 高亮描述
                const descElement = element.querySelector('.chapter-desc');
                if (descElement) {
                    const originalText = descElement.textContent;
                    const highlightedText = originalText.replace(
                        new RegExp(searchTerm, 'gi'),
                        match => `<span class="highlight">${match}</span>`
                    );
                    descElement.innerHTML = highlightedText;
                }
                
                // 高亮标签
                const tagElements = element.querySelectorAll('.molecule-tag');
                tagElements.forEach(tag => {
                    const originalText = tag.textContent;
                    if (originalText.toLowerCase().includes(searchTerm)) {
                        tag.classList.add('highlight');
                    }
                });
            }
            
            // 移除高亮
            function removeHighlights(element) {
                // 恢复标题
                const titleElement = element.querySelector('.chapter-title');
                if (titleElement) {
                    titleElement.innerHTML = titleElement.textContent;
                }
                
                // 恢复描述
                const descElement = element.querySelector('.chapter-desc');
                if (descElement) {
                    descElement.innerHTML = descElement.textContent;
                }
                
                // 移除标签高亮
                const tagElements = element.querySelectorAll('.molecule-tag');
                tagElements.forEach(tag => {
                    tag.classList.remove('highlight');
                });
            }
            
            // 在字符串中高亮文本
            function highlightTextInString(text, searchTerm) {
                if (!searchTerm) return text;
                
                const regex = new RegExp(`(${searchTerm})`, 'gi');
                return text.replace(regex, '<span class="highlight">$1</span>');
            }
            
            // 滚动到指定章节
            function scrollToChapter(chapterId) {
                const chapterElement = document.querySelector(`.chapter-card[data-chapter="${chapterId}"]`);
                if (chapterElement) {
                    // 移除所有filtered-out类
                    chapterCards.forEach(card => card.classList.remove('filtered-out'));
                    
                    // 临时高亮目标章节
                    chapterElement.style.boxShadow = '0 0 0 3px rgba(52, 152, 219, 0.3)';
                    chapterElement.style.transition = 'box-shadow 0.5s ease';
                    
                    // 滚动到元素
                    chapterElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'center'
                    });
                    
                    // 3秒后移除高亮
                    setTimeout(() => {
                        chapterElement.style.boxShadow = '';
                    }, 3000);
                }
            }
            
            // 为章节卡片添加悬停效果
            chapterCards.forEach(card => {
                card.addEventListener('mouseenter', function() {
                    if (!this.classList.contains('filtered-out')) {
                        this.style.transform = 'translateY(-8px)';
                        this.style.boxShadow = '0 20px 40px rgba(0,0,0,0.12)';
                    }
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 5px 15px rgba(0,0,0,0.05)';
                });
            });
            
            // 为分子标签添加点击搜索功能
            document.querySelectorAll('.molecule-tag').forEach(tag => {
                tag.addEventListener('click', function(e) {
                    e.stopPropagation(); // 防止事件冒泡
                    const searchTerm = this.textContent;
                    searchInput.value = searchTerm;
                    currentSearchTerm = searchTerm.toLowerCase();
                    performSearch();
                });
            });
            
            // 平滑滚动效果
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 20,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        });
        
        // 全局函数：设置搜索词
        function setSearchTerm(term) {
            const searchInput = document.getElementById('searchInput');
            searchInput.value = term;
            searchInput.dispatchEvent(new Event('input'));
        }
    </script>
</body>

</html>
